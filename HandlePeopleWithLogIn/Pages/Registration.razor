@page "/registration"
@using HandlePeopleWithLogIn.Data
@using HandlePeopleWithLogIn.Models

@inject NavigationManager NavigationManager
@inject IUserService UserService

<h3>Registration</h3>
<EditForm Model="@newUserItem" OnValidSubmit="@AddNewUser">
    <DataAnnotationsValidator/>
    <ValidationSummary/>
    <div class="form-group"> Username:<br/>
        <InputText @bind-Value="newUserItem.UserName"/>
    </div>
    <div class="form-group"> Password:<br/>
        <InputText type="password" rows="4" @bind-Value="newUserItem.Password"/>
    </div>
    <div class="form-group"> Role:<br/>
        <InputText rows="4" @bind-Value="newUserItem.Role"/>
    </div>
    <p class="actions">
        <button class="btn btn-outline-dark"type="submit">Register</button>
    </p>
</EditForm>

@code {
    private User newUserItem;

    protected override Task OnInitializedAsync()
    {
        SetupNewUser();
        return base.OnInitializedAsync();
    }
    
    private async Task SetupNewUser()
    {
        newUserItem = new User
        {
            UserName = "",
            Password = "",
            Role = ""
        };
    }

    private void AddNewUser()
    {
        UserService.AddUser(newUserItem);
        NavigationManager.NavigateTo("/");
    }
}